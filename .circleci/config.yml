# # Use the latest 2.1 version of CircleCI pipeline process engine. See: https://circleci.com/docs/2.0/configuration-reference
# version: 2.1
# # Use a package of configuration called an orb.
# orbs:
#   # Declare a dependency on the welcome-orb
#   welcome: circleci/welcome-orb@0.4.1
# # Orchestrate or schedule a set of jobs
# workflows:
#   # Name the workflow "welcome"
#   welcome:
#     # Run the welcome/run job in its own container
#     jobs:
#       - welcome/run
#       
# version: 2
# jobs:
#   one:
#     docker:
#       - image: circleci/ruby:2.4.1
#     steps:
#       - checkout
#       - run: echo "A first hello"
#       - run: sleep 25
#   two:
#     docker:
#       - image: circleci/ruby:2.4.1
#     steps:
#       - checkout
#       - run: echo "A more familiar hi"
#       - run: sleep 15
# workflows:
#   version: 2
#   one_and_two:
#     jobs:
#       - one
#       - two
#       
# version: 2
#  workflows:
#    version: 2
#    build-deploy:
#      jobs:
#        - deploy

#  jobs:
#    deploy:
#     docker:
#        - image: circleci/ruby:2.4.1
#      steps:
#        - run: npm install 
#        #     name: Install ant
#        #     command: sudo pip install ant
#        # - run:
#        #     name: Deploy to S3
#        #     command: ant dep
#        
#        
jobs:
  create-open-delete:
    executor: sfdx/default
    steps:
      - checkout
      - sfdx/install
      - sfdx/auth:
          defaultusername: 3659080903@qq.com
      - run: echo ./server.key
      - sfdx/scratch-create:
          scratch-alias: circleci
          scratch-config: ./config/project-scratch-def.json
      - sfdx/scratch-open:
          scratch-alias: circleci
      - sfdx/scratch-delete:
          scratch-alias: circleci
      - run:
        name: Upload Failed Tests
        command: curl --data '{"text": "これは、チャンネル内のテキスト行です。そしてもう1つテキスト行があります。"}'  https://hooks.slack.com/services/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

      curl
orbs:
  sfdx: circleci/salesforce-sfdx@2.0.0
version: 2.1
workflows:
  basic-test:
    jobs:
      - create-open-delete